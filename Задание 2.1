/*
 ============================================================================
 Name        : Задание.c
 Author      : 
 Version     :
 Copyright   : Your copyright notice
 Description : Hello World in C, Ansi-style
 ============================================================================
 */

#include <stdio.h>      // Подключаем библиотеку для работы с файлами и вводом-выводом
#include <stdlib.h>     // Подключаем библиотеку для функций rand() и srand()
#include <time.h>       // Подключаем библиотеку для функции time() для генерации случайных чисел
#include <ctype.h>      // Подключаем библиотеку для функции isdigit() проверки цифр

int main() {
    FILE *file;         // Создаем указатель на файл
    file = fopen("data.txt", "w");  // Открываем файл для записи (режим "w" создает новый файл или перезаписывает существующий)

    if (file == NULL) { // Проверяем, успешно ли открылся файл
        printf("Ошибка открытия файла!\n"); // Выводим сообщение об ошибке
        return 1;       // Завершаем программу с кодом ошибки
    }

    srand(time(NULL));  // Инициализируем генератор случайных чисел текущим временем

    int lines = rand() % 20 + 1;    // Генерируем случайное количество строк (от 1 до 20)
    int chars = 0;                  // Счетчик обычных символов
    int int_count = 0;              // Счетчик целых чисел
    int float_count = 0;            // Счетчик дробных чисел

    for (int i = 0; i < lines; i++) {   // Цикл по количеству строк
        int length = rand() % 50 + 10;  // Случайная длина строки (от 10 до 59 символов)

        for (int j = 0; j < length; j++) {  // Цикл по символам в строке
            int type = rand() % 4;      // Выбираем случайный тип элемента (0-символ, 1-целое, 2-дробное, 3-пробел)

            if (type == 0) {            // Генерируем обычный символ
                char ch = 'a' + rand() % 26;    // Случайная буква от 'a' до 'z'
                fputc(ch, file);        // Записываем символ в файл
                chars++;                // Увеличиваем счетчик символов
            }
            else if (type == 1) {       // Генерируем целое число
                int num = rand() % 1000 - 500;  // Случайное целое от -500 до 499
                fprintf(file, "%d", num);       // Записываем целое число в файл
                fputc(' ', file);               // Добавляем пробел после числа
                int_count++;                    // Увеличиваем счетчик целых чисел
                chars++;                        // Учитываем пробел как символ
            }
            else if (type == 2) {       // Генерируем дробное число
                double fnum = (rand() % 1000) / 100.0 + (rand() % 1000 - 500); // Случайное дробное число
                fprintf(file, "%.2f ", fnum);   // Записываем дробное число с 2 знаками после запятой и пробелом
                float_count++;                  // Увеличиваем счетчик дробных чисел
                chars += 5;                     // Примерно учитываем длину числа + пробел
            }
            else {                      // Добавляем пробел
                fputc(' ', file);       // Записываем пробел
                chars++;                // Увеличиваем счетчик символов
            }
        }
        fputc('\n', file);  // Переходим на новую строку
        chars++;            // Учитываем символ переноса строки
    }

    fclose(file);       // Закрываем файл после записи данных

    // Открываем файл для дописывания статистики
    file = fopen("data.txt", "a");  // Открываем файл в режиме добавления ("a")
    if (file == NULL) { // Проверяем успешность открытия
        printf("Ошибка открытия файла для дописывания!\n");
        return 1;
    }

    // Дописываем строку со статистикой
    fprintf(file, "\nВ файле содержатся %d символов %d строк %d целых чисел %d дробных чисел.",
            chars, lines, int_count, float_count);

    fclose(file);       // Закрываем файл окончательно

    printf("Файл data.txt успешно создан со статистикой!\n"); // Сообщаем об успешном выполнении

    return 0;           // Завершаем программу успешно
}

